import{j as e,h as N,f as j}from"./storage.CyhZc5_V.js";import{r as a}from"./index.Cd_vQiNd.js";function y({seconds:r,onComplete:i,size:t="large",label:g,textColor:o="text-indigo-600",circleColor:c="#6366f1"}){const[m,n]=a.useState(r),[d,h]=a.useState(!1);a.useEffect(()=>{n(r)},[r]),a.useEffect(()=>{if(!d||m<=0){m===0&&i&&i();return}const u=setInterval(()=>{n(x=>x<=1?(h(!1),0):x-1)},1e3);return()=>clearInterval(u)},[d,m,i]);const p=u=>{const x=Math.floor(u/60),l=u%60;return`${x.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},b=m/r*100,f={small:"text-xl",medium:"text-3xl",large:"text-5xl md:text-7xl"},s={small:120,medium:180,large:240};return e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[g&&e.jsx("p",{className:"text-lg font-semibold text-gray-700 mb-4",children:g}),e.jsxs("div",{className:"relative",style:{width:s[t],height:s[t]},children:[e.jsxs("svg",{className:"transform -rotate-90",width:s[t],height:s[t],children:[e.jsx("circle",{cx:s[t]/2,cy:s[t]/2,r:s[t]/2-10,fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),e.jsx("circle",{cx:s[t]/2,cy:s[t]/2,r:s[t]/2-10,fill:"none",stroke:c,strokeWidth:"8",strokeDasharray:`${2*Math.PI*(s[t]/2-10)}`,strokeDashoffset:`${2*Math.PI*(s[t]/2-10)*(1-b/100)}`,className:"transition-all duration-1000 ease-linear"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden",children:e.jsx("span",{className:`font-bold ${o} ${f[t]} leading-none`,children:p(m)})})]}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx("button",{onClick:()=>h(!d),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors",children:d?"Pause":"D√©marrer"}),e.jsx("button",{onClick:()=>{n(r),h(!1)},className:"px-6 py-2 bg-gray-600 text-white rounded-lg font-semibold hover:bg-gray-700 transition-colors",children:"R√©initialiser"})]})]})}function v({session:r,onComplete:i}){const[t,g]=a.useState(0),[o,c]=a.useState("exercise"),[m]=a.useState(()=>Date.now()),n=r.exercises[t]||null,d=t===r.exercises.length-1,h=n?.type||"exercise",p=()=>{n&&n.restTime>0&&!d?c("rest"):f()},b=()=>{f()},f=()=>{d&&o==="rest"?s():d?n&&n.restTime>0?c("rest"):s():(g(t+1),c("exercise"))},s=()=>{const x=Date.now(),l=Math.floor((x-m)/1e3);N({sessionId:r.id,sessionName:r.name,completedAt:x,totalDuration:l}),c("completed"),setTimeout(()=>{i()},2e3)};if(o==="completed")return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üéâ"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"S√©ance termin√©e !"}),e.jsx("p",{className:"text-gray-600",children:"Bravo pour avoir compl√©t√© cette s√©ance !"})]});if(!n)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Aucun exercice disponible"})});const u=(t+(o==="rest"?1:0))/(r.exercises.length*2)*100;return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsxs("span",{children:["Exercice ",t+1," sur ",r.exercises.length]}),e.jsxs("span",{children:[Math.round(u),"% compl√©t√©"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-indigo-600 h-3 rounded-full transition-all duration-500",style:{width:`${u}%`}})})]}),o==="exercise"?(()=>{const l=(()=>{switch(h){case"warmup":return{container:"bg-gradient-to-br from-orange-50 to-yellow-50 border-2 border-orange-200",badge:"bg-orange-600 text-white",badgeText:"√âchauffement",timerColor:"text-orange-600",circleColor:"#ea580c"};case"stretch":return{container:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200",badge:"bg-green-600 text-white",badgeText:"√âtirement",timerColor:"text-green-600",circleColor:"#16a34a"};default:return{container:"bg-white",badge:"bg-indigo-600 text-white animate-pulse-slow",badgeText:"Exercice",timerColor:"text-indigo-600",circleColor:"#6366f1"}}})();return e.jsxs("div",{className:`${l.container} rounded-xl shadow-xl p-8 text-center animate-slide-up`,children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:`px-4 py-2 ${l.badge} rounded-full text-sm font-semibold`,children:l.badgeText})}),e.jsx("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:n.name}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:n.description}),e.jsx(y,{seconds:n.duration,onComplete:p,size:"large",textColor:l.timerColor,circleColor:l.circleColor})]})})():e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl shadow-xl p-8 text-center border-2 border-purple-200 animate-slide-up",children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:"px-4 py-2 bg-purple-600 text-white rounded-full text-sm font-semibold",children:"Repos"})}),e.jsx("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Temps de repos"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Profitez de ce moment pour r√©cup√©rer"}),e.jsx(y,{seconds:n.restTime,onComplete:b,size:"large"})]}),e.jsx("div",{className:"mt-8 flex justify-center gap-4",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Quitter"})})]})}function C({sessionId:r}){const[i,t]=a.useState(()=>j(r)),[g]=a.useState(!1);a.useEffect(()=>{const c=j(r);t(c)},[r]);const o=()=>{window.location.href="/"};return g?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Chargement de la s√©ance..."})}):i?e.jsx(v,{session:i,onComplete:o}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"S√©ance introuvable"}),e.jsx("a",{href:"/",className:"text-indigo-600 hover:text-indigo-700 font-semibold",children:"Retour √† l'accueil"})]})}export{C as default};
